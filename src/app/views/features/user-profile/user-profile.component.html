<main
  [class]="
    'tw-pt-4 tw-pb-4 tw-transition-all tw-duration-300 tw-overflow-auto tw-relative tw-min-h-screen ' +
    (isSidebarCollapsed ? ' tw-ml-16' : ' tw-ml-64')
  "
>
  <!-- Background Watermark - LEFT SIDE -->
  <div class="profile-watermark">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSUrakRDANbeWZlbwBE33hFLh_S6zj-4cOkzQ&s" alt="">
  </div>

  <div class="tw-flex tw-items-center tw-justify-center tw-p-4 tw-min-h-[80vh] tw-relative tw-z-10 tw-bg-gradient-to-br tw-from-gray-50 tw-via-amber-50/20 tw-to-purple-50/10">
    <div class="tw-w-full tw-max-w-4xl">
      <div
        class="tw-rounded-2xl tw-backdrop-blur-sm tw-border-2 tw-border-amber-200 tw-overflow-hidden tw-transform tw-transition-all tw-duration-300 tw-shadow-2xl tw-shadow-purple-200/50 tw-bg-white"
      >
        <div
          class="tw-px-8 tw-pt-8 tw-pb-1 tw-text-left tw-border-b-2 tw-border-amber-200 tw-bg-gradient-to-r tw-from-indigo-900 tw-via-purple-800 tw-to-indigo-900"
        >
          <h2 class="tw-text-2xl tw-font-bold tw-text-amber-100 tw-mb-2">
            Admin Profile
          </h2>
          <p class="tw-text-amber-200 tw-text-sm tw-font-medium">
            Update Your Profile And Keep Your Account Secure
          </p>
        </div>

        <!-- Profile Image Section -->
        <div class="tw-flex tw-justify-center tw-pt-8">
          <div class="tw-relative">
            <img
              [src]="
                previewAvatar
                  ? previewAvatar
                  : getImageUrl(admin.profilePic || '')
              "
              [alt]="admin.name || 'Profile'"
              class="tw-w-28 tw-h-28 tw-rounded-full tw-object-cover tw-border-4 tw-border-amber-300 tw-shadow-2xl tw-shadow-amber-200/50"
            />
            
            <!-- Camera icon for image upload - only visible in edit mode -->
            <label
              *ngIf="isEditMode"
              class="tw-absolute tw-bottom-0 tw-right-0 tw-bg-gradient-to-r tw-from-amber-500 tw-to-yellow-500 tw-text-indigo-950 tw-rounded-full tw-px-2 tw-py-1 tw-w-10 tw-h-10 tw-cursor-pointer tw-flex tw-items-center tw-justify-center tw-shadow-xl tw-transition-all tw-duration-200 hover:tw-scale-110 hover:tw-from-amber-600 hover:tw-to-yellow-600"
              title="Change Profile Picture"
            >
              <input
                type="file"
                accept="image/*"
                class="tw-hidden"
                (change)="onAvatarChange($event)"
              />
              <i class="ph ph-camera tw-text-lg tw-font-bold"></i>
            </label>
            
            <!-- Edit indicator when not in edit mode -->
            <div
              *ngIf="!isEditMode"
              class="tw-absolute tw-bottom-0 tw-right-0 tw-bg-gradient-to-r tw-from-gray-600 tw-to-gray-700 tw-text-white tw-rounded-full tw-px-2 tw-py-1 tw-w-10 tw-h-10 tw-flex tw-items-center tw-justify-center tw-text-xs tw-shadow-lg"
              title="Click Edit Profile to change picture"
            >
              <i class="ph ph-lock tw-text-lg"></i>
            </div>
          </div>
        </div>
        
        <div class="tw-text-center tw-mt-2 tw-pb-4">
          <p class="tw-text-sm tw-text-indigo-900 tw-font-bold">
            {{ isEditMode ? 'Click camera icon to change avatar' : admin.name || 'Admin' }}
          </p>
        </div>

        <div class="tw-px-8 tw-pb-8 tw-pt-8">
          <!-- Loading Indicator -->
          <div *ngIf="isLoading" class="tw-flex tw-justify-center tw-items-center tw-py-8">
            <div class="tw-animate-spin tw-rounded-full tw-h-8 tw-w-8 tw-border-4 tw-border-amber-400 tw-border-t-transparent"></div>
            <span class="tw-ml-2 tw-text-gray-700 tw-font-semibold">Loading profile...</span>
          </div>

          <form
            *ngIf="!isLoading"
            class="tw-space-y-6"
            (ngSubmit)="onSubmit()"
            [formGroup]="profileForm"
          >
            <!-- Grid Row: Name & Mobile -->
            <div class="tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-6">
              <!-- Name -->
              <div class="tw-space-y-2">
                <label
                  class="tw-text-[17px] tw-font-bold tw-text-indigo-900 tw-block"
                >
                  Name
                </label>
                <div class="tw-relative">
                  <div
                    class="tw-absolute tw-inset-y-0 tw-pl-3 tw-flex tw-pointer-events-none"
                  >
                    <i
                      class="ph ph-identification-card tw-text-amber-600 tw-text-lg tw-pt-2"
                    ></i>
                  </div>
                  <input
                    type="text"
                    placeholder="Enter Your Name"
                    formControlName="name"
                    [class]="
                      'tw-w-full tw-pl-10 tw-pr-12 tw-py-2 tw-border-2 tw-border-amber-300 tw-rounded-xl tw-text-sm tw-transition-all tw-duration-200 focus:tw-border-amber-400 focus:tw-ring-2 focus:tw-ring-amber-400 tw-shadow-md ' +
                      (profileForm.get('name')?.disabled ? 'tw-bg-gray-100 tw-cursor-not-allowed' : 'tw-bg-white')
                    "
                  />
                </div>
                <div *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched" class="tw-text-red-600 tw-text-xs tw-mt-1 tw-font-semibold">
                  Name is required (minimum 3 characters)
                </div>
              </div>

              <!-- Mobile -->
              <div class="tw-space-y-2">
                <label
                  class="tw-text-[17px] tw-font-bold tw-text-indigo-900 tw-block"
                >
                  Mobile
                </label>
                <div class="tw-relative">
                  <div
                    class="tw-absolute tw-inset-y-0 tw-pl-3 tw-flex tw-pointer-events-none"
                  >
                    <i
                      class="ph ph-device-mobile-speaker tw-text-amber-600 tw-text-lg tw-pt-2"
                    ></i>
                  </div>
                  <input
                    type="text"
                    placeholder="Enter Your Mobile No"
                    formControlName="mobile"
                    [class]="
                      'tw-w-full tw-pl-10 tw-pr-12 tw-py-2 tw-border-2 tw-border-amber-300 tw-rounded-xl tw-text-sm tw-transition-all tw-duration-200 focus:tw-border-amber-400 focus:tw-ring-2 focus:tw-ring-amber-400 tw-shadow-md ' +
                      (profileForm.get('mobile')?.disabled ? 'tw-bg-gray-100 tw-cursor-not-allowed' : 'tw-bg-white')
                    "
                  />
                </div>
                <div *ngIf="profileForm.get('mobile')?.invalid && profileForm.get('mobile')?.touched" class="tw-text-red-600 tw-text-xs tw-mt-1 tw-font-semibold">
                  Valid mobile number is required (10 digits)
                </div>
              </div>
            </div>

            <!-- Email Full Width -->
            <div class="tw-space-y-2">
              <label
                class="tw-text-[17px] tw-font-bold tw-text-indigo-900 tw-block"
              >
                Email
              </label>
              <div class="tw-relative">
                <div
                  class="tw-absolute tw-inset-y-0 tw-pl-3 tw-flex tw-pointer-events-none"
                >
                  <i
                    class="ph ph-envelope-simple tw-text-amber-600 tw-text-lg tw-pt-2"
                  ></i>
                </div>
                <input
                  type="email"
                  placeholder="Enter Your Email"
                  formControlName="email"
                  [class]="
                    'tw-w-full tw-pl-10 tw-pr-12 tw-py-2 tw-border-2 tw-border-amber-300 tw-rounded-xl tw-text-sm tw-transition-all tw-duration-200 focus:tw-border-amber-400 focus:tw-ring-2 focus:tw-ring-amber-400 tw-shadow-md ' +
                    (profileForm.get('email')?.disabled ? 'tw-bg-gray-100 tw-cursor-not-allowed' : 'tw-bg-white')
                  "
                />
              </div>
              <div *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="tw-text-red-600 tw-text-xs tw-mt-1 tw-font-semibold">
                Valid email address is required
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="tw-pt-4 tw-flex tw-gap-4">
              <!-- Edit/Update Button -->
              <button 
                *ngIf="!isEditMode" 
                type="button" 
                (click)="toggleEditMode()"
                class="tw-flex-1 tw-bg-gradient-to-r tw-from-amber-500 tw-to-yellow-500 hover:tw-from-amber-600 hover:tw-to-yellow-600 tw-text-indigo-950 tw-font-bold tw-px-6 tw-py-3 tw-rounded-xl tw-flex tw-items-center tw-justify-center tw-gap-2 tw-transition-all tw-duration-200 tw-shadow-lg hover:tw-shadow-xl"
              >
                <i class="ph ph-pencil tw-text-xl"></i>
                Edit Profile
              </button>

              <button 
                *ngIf="isEditMode" 
                type="submit" 
                [disabled]="profileForm.invalid || isLoading"
                class="tw-flex-1 tw-bg-gradient-to-r tw-from-amber-500 tw-to-yellow-500 hover:tw-from-amber-600 hover:tw-to-yellow-600 disabled:tw-from-gray-300 disabled:tw-to-gray-400 tw-text-indigo-950 tw-font-bold tw-px-6 tw-py-3 tw-rounded-xl tw-flex tw-items-center tw-justify-center tw-gap-2 tw-transition-all tw-duration-200 tw-shadow-lg hover:tw-shadow-xl disabled:tw-opacity-50 disabled:tw-cursor-not-allowed"
              >
                <i class="ph ph-floppy-disk tw-text-xl"></i>
                Update Profile
              </button>

              <!-- Cancel/Reset Button -->
              <button
                *ngIf="isEditMode"
                type="button"
                (click)="toggleEditMode()"
                class="tw-flex-1 tw-bg-gradient-to-r tw-from-gray-600 tw-to-gray-700 hover:tw-from-gray-700 hover:tw-to-gray-800 tw-text-white tw-font-bold tw-px-6 tw-py-3 tw-rounded-xl tw-flex tw-items-center tw-justify-center tw-gap-2 tw-transition-all tw-duration-200 tw-shadow-lg hover:tw-shadow-xl"
              >
                <i class="ph ph-x tw-text-xl"></i>
                Cancel
              </button>

              <button
                *ngIf="!isEditMode"
                type="button"
                (click)="loadUserProfile()"
                class="tw-flex-1 tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-600 hover:tw-from-indigo-700 hover:tw-to-purple-700 tw-text-white tw-font-bold tw-px-6 tw-py-3 tw-rounded-xl tw-flex tw-items-center tw-justify-center tw-gap-2 tw-transition-all tw-duration-200 tw-shadow-lg hover:tw-shadow-xl"
              >
                <i class="ph ph-arrows-clockwise tw-text-xl"></i>
                Refresh
              </button>
            </div>

            <!-- Gradient Line -->
            <div
              class="tw-h-1 tw-bg-gradient-to-r tw-from-amber-500 tw-via-yellow-500 tw-to-amber-500 tw-rounded-full tw-mt-6"
            ></div>

            <!-- Footer -->
            <div class="tw-text-center tw-mt-6">
              <p class="tw-text-sm tw-text-gray-600">
                Need help?
                <a href="#" class="tw-font-bold tw-text-amber-600 hover:tw-text-amber-700 tw-transition-colors">
                  Contact Support
                </a>
              </p>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</main>